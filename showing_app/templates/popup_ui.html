
{% load static %}


<!-- Intro -->

<h2 class="major">Admin Menu  </h2>
<span class="image main"><img src="{% static 'images/DBU.png' %}" alt="" /></span>
<h2>ğŸ”’ê´€ë¦¬ìMENUğŸ”’</h2>
<ul class="actions">
    <li><input  type="button" value="íŒ¨ìŠ¤ì½”ë“œ ë³€ê²½"  onclick="change_location('admin')"/></li>
    <li><input name="home" type="button" value="ì¶œì„í˜„í™©" onclick="change_location('attendance')"/></li>
</ul>

<script>
    new_h2_added=false;

    function change_location(name){
        var url;
        var tmp=false;//tmpëŠ” ì§€ê¸ˆ íŒì—…ë²„íŠ¼ê³¼ ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ì´ ìˆëŠ” ì¦‰ ê´€ë¦¬ì°½í˜ì´ì§€ ë©”ë‰´ì—ì„œ ìƒˆë¡­ê²Œ ë‹¤ì‹œ ë“¤ì–´ì˜¬ë•Œ ì‚¬ì „ì— ì¨ì ¸ìˆì„ ìˆ˜ ìˆëŠ” h2íƒœê·¸ë¥¼ ì§€ìš°ê¸° ìœ„í•œ í”Œë˜ê·¸
        if(name=="admin"){
            //  autoclick_popup("passcode");
            window.location.href="#passcode_article"
        }
        else if(name=="attendance"){
            window.location.href="#attendance"
            getServerdata();
        }
        else if(name=="popup_page"){
            window.location.href="{% url 'admin_after_login' %}";
            tmp=true;
        }
        else if(name=="logout"){
			window.location.href="{% url 'admin_logout' %}";
            tmp=true;
		}

        if (tmp==true){//ì¦‰ ê´€ë¦¬ìì°½ ë©”ë‰´ë¼ëŠ” ê²ƒ
            if(new_h2_added==true){//ê·¼ë° ë§Œì•½ì— ê·¸ì „ì— ìˆë˜ h2ê°€ ìˆìœ¼ë©´ íƒœê·¸ë¥¼ ì§€ì›Œë‹¬ë¼ ì´ëŸ° ëœ», ì—†ìœ¼ë©´ ë§ê³ ?
                $("#no_attendance").remove();
            }
        }
        
       
        
    }
 
    function getServerdata(){

        $.ajax({
                            type: "POST",
                            url: "{% url 'admin_after_login' %}",
                            data: '{"where":"check_attendance"}',
                            dataType: 'json',
                            success: function (data) {
                                // alert("success");
                                console.log(data.attendance_list);
                                var tbody=document.getElementById("attendance_body");
                                document.getElementById("attendance_date").innerHTML=data.result_date+"ğŸ™‹â€â™‚ï¸ì¶œì„í˜„í™©";
                                document.getElementById("date").innerHTML="ğŸ“†Date"+data.result_date;

                                if(data.result_message!="ì¶œì„ì¸ì›ì´ ì¡´ì¬í•©ë‹ˆë‹¤"){
                                    var new_alert=document.createElement("h2");
                                    var txt=document.createTextNode(data.result_message);
                                    new_alert.setAttribute("id","no_attendance");
                                    new_alert.appendChild(txt);
                                    var target=document.getElementById("attendance");
                                    target.appendChild(new_alert);
                                    new_h2_added=true;
                                    return;
                                }
                                for (var name in data.attendance_list){
                                    var row=tbody.insertRow(tbody.rows.length);
                                    var cell1=row.insertCell(0);
                                    var cell2=row.insertCell(1);

                                    console.log(name);
                                    cell1.innerHTML=data.attendance_list[name];
                                    cell2.innerHTML='âœ”';
                                }
                                var row=tbody.insertRow(tbody.rows.length);
                                var cell1=row.insertCell(0);
                                var cell2=row.insertCell(1);

                                cell1.innerHTML="ì¶œì„ì¸ì›:";
                                cell2.innerHTML=data.attendance_list.length+"ëª…";

                            },
                            error: function (request, status, error) {
                                console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
            
                            }
                        });
    }

    
</script>	